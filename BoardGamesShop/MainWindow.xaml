<Window x:Class="BoardGamesShop.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:models="clr-namespace:DataModels"
        xmlns:conv="clr-namespace:BoardGamesShop.Converters"
        Title="Obchod deskových her"
        Height="750"
        Width="1100"
        Background="#F5F5DC">

    <Window.Resources>
        <BooleanToVisibilityConverter x:Key="BoolToVis" />
        <conv:InverseBooleanToVisibilityConverter x:Key="InverseBoolToVis" />
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="48" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <Grid Grid.Row="0" Background="#FFF7E6">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>

            <TextBlock Grid.Column="0"
                       Text="Obchod deskových her"
                       VerticalAlignment="Center"
                       Margin="12,0"
                       FontSize="18"
                       FontWeight="Bold"
                       Foreground="#574D35" />

            <StackPanel Grid.Column="1"
                        Orientation="Horizontal"
                        VerticalAlignment="Center"
                        Margin="20,0">

                <StackPanel Orientation="Horizontal"
                            Visibility="{Binding IsLoggedIn,
                                                 Converter={StaticResource InverseBoolToVis}}">
                    <Button Content="Přihlásit"
                            Command="{Binding LoginCommand}"
                            Background="#FF6C6C"
                            Foreground="White"
                            FontWeight="Bold"
                            FontSize="12"
                            Padding="5"
                            Margin="0,0,10,0"
                            BorderThickness="0"
                            Cursor="Hand"
                            HorizontalAlignment="Stretch"
                            BorderBrush="#FF6C6C"
                            Height="30" />
                    <Button Content="Registrovat"
                            Command="{Binding RegisterCommand}"
                            Background="#FF6C6C"
                            Foreground="White"
                            FontWeight="Bold"
                            FontSize="12"
                            Padding="5"
                            Margin="0,0,0,0"
                            BorderThickness="0"
                            Cursor="Hand"
                            HorizontalAlignment="Stretch"
                            BorderBrush="#FF6C6C"
                            Height="30" />
                </StackPanel>

                <StackPanel Orientation="Horizontal"
                            Margin="12,0,0,0"
                            Visibility="{Binding IsLoggedIn,
                                                 Converter={StaticResource BoolToVis}}">
                    <TextBlock Text="Uživatel:"
                               VerticalAlignment="Center"
                               Margin="0,0,6,0" />
                    <TextBlock FontWeight="Bold"
                               VerticalAlignment="Center"
                               Margin="0,0,8,0"
                               Text="{Binding CurrentUserName}" />
                    <Button Content="Odhlásit"
                            Command="{Binding LogoutCommand}"
                            Background="#FF6C6C"
                            Foreground="White"
                            FontWeight="Bold"
                            FontSize="12"
                            Padding="5"
                            Margin="0,0,10,0"
                            BorderThickness="0"
                            Cursor="Hand"
                            HorizontalAlignment="Stretch"
                            BorderBrush="#FF6C6C"
                            Height="30" />
                </StackPanel>
            </StackPanel>

            <StackPanel Grid.Column="2"
                        Orientation="Horizontal"
                        VerticalAlignment="Center"
                        Margin="10,0"
                        Visibility="{Binding IsAdmin,
                                             Converter={StaticResource BoolToVis}}">
                <Button Content="Přidat hru"
                        Command="{Binding OpenAddGameCommand}"
                        Background="#FF6C6C"
                        Foreground="White"
                        FontWeight="Bold"
                        FontSize="12"
                        Padding="5"
                        Margin="0,0,10,0"
                        BorderThickness="0"
                        Cursor="Hand"
                        HorizontalAlignment="Stretch"
                        BorderBrush="#FF6C6C"
                        Height="30" />
                <Button Content="Upravit ceny"
                        Command="{Binding OpenEditPricesCommand}"
                        Background="#FF6C6C"
                        Foreground="White"
                        FontWeight="Bold"
                        FontSize="12"
                        Padding="5"
                        Margin="0,0,10,0"
                        BorderThickness="0"
                        Cursor="Hand"
                        HorizontalAlignment="Stretch"
                        BorderBrush="#FF6C6C"
                        Height="30" />
            </StackPanel>

            <Button Grid.Column="3"
                    Margin="0,0,12,0"
                    VerticalAlignment="Center"
                    Padding="10,6"
                    Background="#4FC0CE"
                    Foreground="White"
                    BorderBrush="#4FC0CE"
                    Command="{Binding OpenCartCommand}">
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="🛒"
                               Margin="0,0,6,0" />
                    <TextBlock Text="Košík" />
                    <Border Background="White"
                            CornerRadius="10"
                            Margin="8,0,0,0"
                            Padding="6,0">
                        <TextBlock Foreground="#4FC0CE"
                                   Text="{Binding CartCount}" />
                    </Border>
                </StackPanel>
            </Button>
        </Grid>

        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="300" />
            </Grid.ColumnDefinitions>

            <TabControl x:Name="MainTabs"
                        Grid.Column="0"
                        Background="#EAE0C8">
                <TabControl.Resources>
                    <Style TargetType="TabItem">
                        <Setter Property="Background" Value="#EAE0C8" />
                        <Setter Property="BorderBrush" Value="#FFAD9C72" />
                        <Setter Property="Padding" Value="10,4" />
                    </Style>
                </TabControl.Resources>

                <TabItem Header="Všechny hry">
                    <ScrollViewer>
                        <ItemsControl ItemsSource="{Binding FilteredGames}">
                            <ItemsControl.ItemsPanel>
                                <ItemsPanelTemplate>
                                    <WrapPanel />
                                </ItemsPanelTemplate>
                            </ItemsControl.ItemsPanel>

                            <ItemsControl.ItemTemplate>
                                <DataTemplate DataType="{x:Type models:Game}">
                                    <Border Width="220"
                                            Background="White"
                                            BorderBrush="LightGray"
                                            BorderThickness="1"
                                            CornerRadius="5"
                                            Margin="10">
                                        <StackPanel>

                                            <Image Height="185"
                                                   Margin="10"
                                                   Stretch="UniformToFill"
                                                   Loaded="GameImage_Loaded" />

                                            <Button HorizontalAlignment="Right"
                                                    Background="Transparent"
                                                    BorderBrush="Transparent"
                                                    FontSize="16"
                                                    Cursor="Hand"
                                                    Margin="5,0,5,0"
                                                    Command="{Binding DataContext.ToggleFavoriteCommand,
                                                                      RelativeSource={RelativeSource AncestorType=Window}}"
                                                    CommandParameter="{Binding}">
                                                <Button.Style>
                                                    <Style TargetType="Button">
                                                        <Setter Property="Content" Value="🤍" />
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding IsFavorite}" Value="True">
                                                                <Setter Property="Content" Value="❤️" />
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </Button.Style>
                                            </Button>


                                            <Button Content="Do košíku"
                                                    Margin="5,0,5,5"
                                                    Padding="8,4"
                                                    Background="#4FC0CE"
                                                    Foreground="White"
                                                    BorderBrush="#4FC0CE"
                                                    Cursor="Hand"
                                                    Command="{Binding DataContext.AddToCartCommand,
                                                                      RelativeSource={RelativeSource AncestorType=Window}}"
                                                    CommandParameter="{Binding}" />

                                            <WrapPanel HorizontalAlignment="Left"
                                                       Margin="5,0,5,5">
                                                <StackPanel Orientation="Horizontal"
                                                            Margin="0,0,10,0">
                                                    <TextBlock Text="👥"
                                                               FontSize="12" />
                                                    <TextBlock FontSize="12"
                                                               Margin="3,0,0,0">
                                                        <Run Text="{Binding MinPlayers}" />
                                                        <Run Text="–" />
                                                        <Run Text="{Binding MaxPlayers}" />
                                                    </TextBlock>
                                                </StackPanel>

                                                <StackPanel Orientation="Horizontal">
                                                    <TextBlock Text="⏱"
                                                               FontSize="12" />
                                                    <TextBlock FontSize="12"
                                                               Margin="3,0,0,0"
                                                               Text="{Binding PlayTime, StringFormat='{}{0} min'}" />
                                                </StackPanel>
                                            </WrapPanel>

                                            <TextBlock Text="{Binding Age, StringFormat='{}{0}+'}"
                                                       Foreground="Gray"
                                                       FontSize="12"
                                                       Margin="5,0,0,5" />

                                            <TextBlock FontSize="12"
                                                       Foreground="Black"
                                                       Margin="5,0,0,5"
                                                       Loaded="AuthorBlock_Loaded" />

                                            <TextBlock Text="{Binding Name}"
                                                       FontSize="14"
                                                       FontWeight="Bold"
                                                       Margin="5"
                                                       TextWrapping="Wrap" />

                                            <TextBlock Text="{Binding Price, StringFormat='{}{0},-'}"
                                                       FontSize="16"
                                                       Foreground="DarkRed"
                                                       Margin="5,0,0,5"
                                                       FontWeight="SemiBold" />

                                            <ItemsControl Margin="5,0,5,5"
                                                          Loaded="GenresItems_Loaded">
                                                <ItemsControl.ItemsPanel>
                                                    <ItemsPanelTemplate>
                                                        <WrapPanel />
                                                    </ItemsPanelTemplate>
                                                </ItemsControl.ItemsPanel>
                                                <ItemsControl.ItemTemplate>
                                                    <DataTemplate>
                                                        <Border Background="#E6E6E6"
                                                                CornerRadius="4"
                                                                Margin="3,2"
                                                                Padding="6,2"
                                                                VerticalAlignment="Center">
                                                            <TextBlock Text="{Binding}"
                                                                       FontSize="11"
                                                                       Foreground="Black"
                                                                       VerticalAlignment="Center" />
                                                        </Border>
                                                    </DataTemplate>
                                                </ItemsControl.ItemTemplate>
                                            </ItemsControl>

                                        </StackPanel>
                                    </Border>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </ScrollViewer>
                </TabItem>

                <TabItem Header="Oblíbené">
                    <ScrollViewer>
                        <ItemsControl ItemsSource="{Binding FavoriteGames}">
                            <ItemsControl.ItemsPanel>
                                <ItemsPanelTemplate>
                                    <WrapPanel />
                                </ItemsPanelTemplate>
                            </ItemsControl.ItemsPanel>

                            <ItemsControl.ItemTemplate>
                                <DataTemplate DataType="{x:Type models:Game}">
                                    <Border Width="220"
                                            Background="White"
                                            BorderBrush="LightGray"
                                            BorderThickness="1"
                                            CornerRadius="5"
                                            Margin="10">
                                        <StackPanel>

                                            <Image Height="185"
                                                   Margin="10"
                                                   Stretch="UniformToFill"
                                                   Loaded="GameImage_Loaded" />

                                            <Button HorizontalAlignment="Right"
                                                    Background="Transparent"
                                                    BorderBrush="Transparent"
                                                    FontSize="16"
                                                    Cursor="Hand"
                                                    Margin="5,0,5,0"
                                                    Command="{Binding DataContext.ToggleFavoriteCommand,
                                                                      RelativeSource={RelativeSource AncestorType=Window}}"
                                                    CommandParameter="{Binding}">
                                                <Button.Style>
                                                    <Style TargetType="Button">
                                                        <Setter Property="Content" Value="🤍" />
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding IsFavorite}" Value="True">
                                                                <Setter Property="Content" Value="❤️" />
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </Button.Style>
                                            </Button>


                                            <Button Content="Do košíku"
                                                    Margin="5,0,5,5"
                                                    Padding="8,4"
                                                    Background="#4FC0CE"
                                                    Foreground="White"
                                                    BorderBrush="#4FC0CE"
                                                    Cursor="Hand"
                                                    Command="{Binding DataContext.AddToCartCommand,
                                                                      RelativeSource={RelativeSource AncestorType=Window}}"
                                                    CommandParameter="{Binding}" />

                                            <WrapPanel HorizontalAlignment="Left"
                                                       Margin="5,0,5,5">
                                                <StackPanel Orientation="Horizontal"
                                                            Margin="0,0,10,0">
                                                    <TextBlock Text="👥"
                                                               FontSize="12" />
                                                    <TextBlock FontSize="12"
                                                               Margin="3,0,0,0">
                                                        <Run Text="{Binding MinPlayers}" />
                                                        <Run Text="–" />
                                                        <Run Text="{Binding MaxPlayers}" />
                                                    </TextBlock>
                                                </StackPanel>

                                                <StackPanel Orientation="Horizontal">
                                                    <TextBlock Text="⏱"
                                                               FontSize="12" />
                                                    <TextBlock FontSize="12"
                                                               Margin="3,0,0,0"
                                                               Text="{Binding PlayTime, StringFormat='{}{0} min'}" />
                                                </StackPanel>
                                            </WrapPanel>

                                            <TextBlock Text="{Binding Age, StringFormat='{}{0}+'}"
                                                       Foreground="Gray"
                                                       FontSize="12"
                                                       Margin="5,0,0,5" />

                                            <TextBlock FontSize="12"
                                                       Foreground="Black"
                                                       Margin="5,0,0,5"
                                                       Loaded="AuthorBlock_Loaded" />

                                            <TextBlock Text="{Binding Name}"
                                                       FontSize="14"
                                                       FontWeight="Bold"
                                                       Margin="5"
                                                       TextWrapping="Wrap" />

                                            <TextBlock Text="{Binding Price, StringFormat='{}{0},-'}"
                                                       FontSize="16"
                                                       Foreground="DarkRed"
                                                       Margin="5,0,0,5"
                                                       FontWeight="SemiBold" />

                                            <ItemsControl Margin="5,0,5,5"
                                                          Loaded="GenresItems_Loaded">
                                                <ItemsControl.ItemsPanel>
                                                    <ItemsPanelTemplate>
                                                        <WrapPanel />
                                                    </ItemsPanelTemplate>
                                                </ItemsControl.ItemsPanel>
                                                <ItemsControl.ItemTemplate>
                                                    <DataTemplate>
                                                        <Border Background="#E6E6E6"
                                                                CornerRadius="4"
                                                                Margin="3,2"
                                                                Padding="6,2"
                                                                VerticalAlignment="Center">
                                                            <TextBlock Text="{Binding}"
                                                                       FontSize="11"
                                                                       Foreground="Black"
                                                                       VerticalAlignment="Center" />
                                                        </Border>
                                                    </DataTemplate>
                                                </ItemsControl.ItemTemplate>
                                            </ItemsControl>

                                        </StackPanel>
                                    </Border>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </ScrollViewer>
                </TabItem>
            </TabControl>

            <Grid Grid.Column="1"
                  Background="#FFFBEF">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="*" />
                </Grid.RowDefinitions>

                <StackPanel Margin="10">
                    <TextBlock Text="Vyhledávání"
                               FontSize="16"
                               FontWeight="Bold"
                               Margin="0,0,0,8" />
                    <DockPanel>
                        <TextBox x:Name="SearchBox"
                                 Width="266"
                                 Height="28"
                                 Margin="0,0,5,0"
                                 TextChanged="SearchBox_TextChanged"
                                 ToolTip="Hledat podle názvu" />
                    </DockPanel>
                </StackPanel>

                <ScrollViewer Grid.Row="1"
                              VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="10"
                                Orientation="Vertical">

                        <StackPanel Margin="15,12,15,12">
                            <TextBlock Text="Žánry"
                                       FontWeight="Bold"
                                       Margin="0,0,0,5" />
                            <ListBox x:Name="GenresList"
                                     SelectionMode="Multiple"
                                     Background="Transparent"
                                     Foreground="#FFAD9C72"
                                     MaxHeight="250"
                                     BorderBrush="Transparent"
                                     SelectionChanged="GenresList_SelectionChanged"
                                     PreviewMouseDown="GenresList_PreviewMouseDown" />
                        </StackPanel>

                        <StackPanel Margin="15,12,15,12">
                            <TextBlock Text="Cena"
                                       FontWeight="Bold"
                                       Margin="0,0,0,5" />
                            <StackPanel Orientation="Horizontal"
                                        Margin="0,0,0,5">
                                <TextBlock Text="Od"
                                           VerticalAlignment="Center" />
                                <TextBox x:Name="PriceFromTextBox"
                                         Width="60"
                                         Margin="5,0"
                                         TextChanged="PriceTextBox_TextChanged" />
                                <TextBlock Text="Do"
                                           VerticalAlignment="Center"
                                           Margin="10,0,0,0" />
                                <TextBox x:Name="PriceToTextBox"
                                         Width="60"
                                         Margin="5,0"
                                         TextChanged="PriceTextBox_TextChanged" />
                            </StackPanel>
                            <Slider x:Name="PriceSlider"
                                    Minimum="0"
                                    Maximum="19990"
                                    ValueChanged="PriceSlider_ValueChanged"
                                    Margin="0,0,0,5" />
                        </StackPanel>

                        <StackPanel Margin="15,12,15,12">
                            <TextBlock Text="Věk"
                                       FontWeight="Bold"
                                       Margin="0,0,0,5" />
                            <WrapPanel>
                                <RadioButton x:Name="Age0RadioButton"
                                             Content="0+"
                                             Tag="0"
                                             Margin="0,0,10,5"
                                             Checked="AgeRadioButton_Checked"
                                             PreviewMouseLeftButtonDown="AgeRadioButton_PreviewMouseLeftButtonDown" />
                                <RadioButton x:Name="Age4RadioButton"
                                             Content="4+"
                                             Tag="4"
                                             Margin="0,0,10,5"
                                             Checked="AgeRadioButton_Checked"
                                             PreviewMouseLeftButtonDown="AgeRadioButton_PreviewMouseLeftButtonDown" />
                                <RadioButton x:Name="Age10RadioButton"
                                             Content="10+"
                                             Tag="10"
                                             Margin="0,0,10,5"
                                             Checked="AgeRadioButton_Checked"
                                             PreviewMouseLeftButtonDown="AgeRadioButton_PreviewMouseLeftButtonDown" />
                                <RadioButton x:Name="Age14RadioButton"
                                             Content="14+"
                                             Tag="14"
                                             Margin="0,0,10,5"
                                             Checked="AgeRadioButton_Checked"
                                             PreviewMouseLeftButtonDown="AgeRadioButton_PreviewMouseLeftButtonDown" />
                                <RadioButton x:Name="Age16RadioButton"
                                             Content="16+"
                                             Tag="16"
                                             Margin="0,0,10,5"
                                             Checked="AgeRadioButton_Checked"
                                             PreviewMouseLeftButtonDown="AgeRadioButton_PreviewMouseLeftButtonDown" />
                                <RadioButton x:Name="Age18RadioButton"
                                             Content="18+"
                                             Tag="18"
                                             Margin="0,0,10,5"
                                             Checked="AgeRadioButton_Checked"
                                             PreviewMouseLeftButtonDown="AgeRadioButton_PreviewMouseLeftButtonDown" />
                            </WrapPanel>
                        </StackPanel>

                        <StackPanel Margin="15,12,15,12">
                            <TextBlock Text="Počet hráčů"
                                       FontWeight="Bold"
                                       Margin="0,0,0,5" />
                            <Slider x:Name="PlayerSlider"
                                    Minimum="0"
                                    Maximum="7"
                                    Value="0"
                                    TickFrequency="1"
                                    IsSnapToTickEnabled="True"
                                    ValueChanged="PlayerSlider_ValueChanged" />
                            <UniformGrid Columns="8">
                                <TextBlock Text="Nevadí"
                                           HorizontalAlignment="Center"
                                           FontSize="10" />
                                <TextBlock Text="1"
                                           HorizontalAlignment="Center"
                                           FontSize="10" />
                                <TextBlock Text="2"
                                           HorizontalAlignment="Center"
                                           FontSize="10" />
                                <TextBlock Text="3"
                                           HorizontalAlignment="Center"
                                           FontSize="10" />
                                <TextBlock Text="4"
                                           HorizontalAlignment="Center"
                                           FontSize="10" />
                                <TextBlock Text="5"
                                           HorizontalAlignment="Center"
                                           FontSize="10" />
                                <TextBlock Text="6"
                                           HorizontalAlignment="Center"
                                           FontSize="10" />
                                <TextBlock Text="Více"
                                           HorizontalAlignment="Center"
                                           FontSize="10" />
                            </UniformGrid>
                        </StackPanel>

                        <StackPanel Margin="15,12,15,12"
                                    Height="95">
                            <TextBlock Text="Délka hry"
                                       FontWeight="Bold"
                                       Margin="0,0,0,5" />
                            <WrapPanel>
                                <RadioButton x:Name="PlayTime30CheckBox"
                                             Content="do 30 min"
                                             Margin="0,0,10,5"
                                             Checked="PlayTime_Checked"
                                             Unchecked="PlayTime_Checked"
                                             PreviewMouseLeftButtonDown="PlayTimeRadioButton_PreviewMouseLeftButtonDown" />
                                <RadioButton x:Name="PlayTime60CheckBox"
                                             Content="do 60 min"
                                             Margin="0,0,10,5"
                                             Checked="PlayTime_Checked"
                                             Unchecked="PlayTime_Checked"
                                             PreviewMouseLeftButtonDown="PlayTimeRadioButton_PreviewMouseLeftButtonDown" />
                                <RadioButton x:Name="PlayTime120CheckBox"
                                             Content="do 2 hodin"
                                             Margin="0,0,10,5"
                                             Checked="PlayTime_Checked"
                                             Unchecked="PlayTime_Checked"
                                             PreviewMouseLeftButtonDown="PlayTimeRadioButton_PreviewMouseLeftButtonDown" />
                                <RadioButton x:Name="PlayTimeMoreCheckBox"
                                             Content="déle"
                                             Margin="0,0,10,5"
                                             Checked="PlayTime_Checked"
                                             Unchecked="PlayTime_Checked"
                                             PreviewMouseLeftButtonDown="PlayTimeRadioButton_PreviewMouseLeftButtonDown" />
                            </WrapPanel>
                        </StackPanel>

                        <Button Content="🔄 Resetovat filtry"
                                Click="ResetFilters_Click"
                                Background="#FF6C6C"
                                Foreground="White"
                                FontWeight="Bold"
                                FontSize="14"
                                Padding="10,5"
                                Margin="15,20,15,10"
                                BorderThickness="0"
                                Cursor="Hand"
                                HorizontalAlignment="Stretch"
                                BorderBrush="#FF6C6C"
                                Height="40" />
                    </StackPanel>
                </ScrollViewer>
            </Grid>
        </Grid>
    </Grid>
</Window>
